#include "stdafx.h"
#include "EaselFailScreenLogic.h"
#include "Minigames.h"
#include "MinigamesMain.h"
#include "MinigameCommands.h"
#include "EaselMinigame.h"

namespace PF_Minigames
{

//////////////////////////////////////////////////////////////////////////
//
// class EaselFailScreenLogic implementation
//
//////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
BEGIN_LUA_TYPEINFO( EaselFailScreenLogic, UI::ClientScreenUILogicBase )
  LUA_METHOD( Exit )
END_LUA_TYPEINFO( EaselFailScreenLogic )

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

EaselFailScreenLogic::EaselFailScreenLogic() 
: UI::ClientScreenUILogicBase()
, fIsInit(false)
{

}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
EaselFailScreenLogic::~EaselFailScreenLogic()
{
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void EaselFailScreenLogic::Init( PF_Minigames::Minigames* minigames )
{
  if ( fIsInit  )
    return;

  associatedMinigames = minigames;

  fIsInit = true;
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void EaselFailScreenLogic::InitLayout()
{
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void EaselFailScreenLogic::Step( float deltaTime )
{
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void EaselFailScreenLogic::Exit()
{
  if( !fIsInit )
    return;

  CPtr<EaselMinigame> easelMinigame = associatedMinigames->GetNativeMinigame<EaselMinigame>("Easel");
  if(IsValid( easelMinigame ) )
  {
    easelMinigame->StopLevelLocal();
  }

  easelMinigame->GetScreensManager().PopFailureScreen();
}

} //namespace PF_Minigames
