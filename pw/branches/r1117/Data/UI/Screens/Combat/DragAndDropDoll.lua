-------------------------------------------------------------------------------------------------------------------------------ActionBarDragNDropDoll = ActionBarDragNDropDoll or {}-------------------------------------------------------------------------------------------------------------------------------function ActionBarDragNDropDoll:SetupImage() -- We CAN NOT do this in OnInit()  local image = self:GetChild( "Image" )  self.context:SetDnDControlmage( image, self.dndSlotType, self.slotIndex )end-------------------------------------------------------------------------------------------------------------------------------function ActionBarDragNDropDoll:OnMouseDown( action )  clog( "ActionBarDragNDropDoll:OnMouseDown: " ..tostring(self.classicMode) )  if not self.classicMode then    if action == WINDOW_LMBUTTON then      self.context:Drop( false )      self:Close()    elseif action == WINDOW_RMBUTTON then      self.context:CancelDrag()      self:Close()    end  end  return trueend-------------------------------------------------------------------------------------------------------------------------------function ActionBarDragNDropDoll:OnMouseUp( action )  clog( "ActionBarDragNDropDoll:OnMouseUp: " ..tostring(self.classicMode) )  if ( action == WINDOW_RMBUTTON ) and self.classicMode then    self.context:Drop( false )    self:Close()  end  return trueend-------------------------------------------------------------------------------------------------------------------------------function ActionBarDragNDropDoll:OnDrop( id, target )  clog( "ActionBarDragNDropDoll:OnDrop: " .. tostring( target ) )  if target then    clog( "Target: " .. tostring( target.name ) )    self.context:DropItemToActionBar( self.dndSlotType, self.slotIndex, target.parent.dndSlotType, target.slotIndex )  else    local x = self.sx + self.sw / 2    local y = self.sy + self.sh / 2    clog( "Position: " .. tostring( x ) .. ", " .. tostring( y ) )    self.context:DropItemToPosition( self.dndSlotType, self.slotIndex, x, y )  endend-------------------------------------------------------------------------------------------------------------------------------function ActionBarDragNDropDoll:OnCancelDrag( id )  clog( "ActionBarDragNDropDoll:OnCancelDrag" )  self:Close()end