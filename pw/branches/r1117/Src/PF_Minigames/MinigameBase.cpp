#include "stdafx.h"

#include "MinigameBase.h"
#include "Minigames.h"
#include "MinigameCommands.h"
#include "MinigamesMain.h"

//To get to statistics
#include "../PF_GameLogic/PFWorld.h"


namespace PF_Minigames
{

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
MinigameBase::MinigameBase() :
pausedNow(false)
{

}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
MinigameBase::~MinigameBase()
{
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
NWorld::PFStatistics * MinigameBase::GetStatistics()
{
  return minigames->GetWorldSessionInterface()->GetSessionWorld()->GetStatistics();
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
int MinigameBase::GetPriestessId()
{
  return minigames->GetWorldSessionInterface()->GetPriestessID();
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
int MinigameBase::GetUserId()
{
  return minigames->GetWorldSessionInterface()->GetPriestessUserId();
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
bool MinigameBase::InitMinigames( Minigames * _minigames, NScene::IScene * _scene )
{
  minigames = _minigames;
  scene = _scene;
  return true;
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
bool MinigameBase::InitiatePause(bool enablePause)
{
  if( enablePause )
  { //pause
    if( pausedNow )
      return false;
  }
  else
  { //unpause
    if( !pausedNow )
      return false;
  }

  pausedNow = enablePause;

  SendPauseMinigameCommand( minigames->GetWorldSessionInterface(), pausedNow );

  return true;
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
const NDb::DBID & MinigameBase::getDBID() const
{
  static NDb::DBID nullId;
  return nullId;
}


} // namespace PF_Minigames

BASIC_REGISTER_CLASS(PF_Minigames::MinigameBase)
