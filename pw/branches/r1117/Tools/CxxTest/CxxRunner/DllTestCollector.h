#pragma once

#include "TestCollector.h"
#include "LibraryGuard.h"
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
namespace CxxTest
{
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
class CDllTestCollector : public CTestCollector
{
	const char *szDllFile;
	NHelpers::CLibraryGuard library;
protected:
	bool setUp();
	bool tearDown();

	bool collect( GlobalFixtureList &globalFixtures, SuiteDescriptionList &suiteDescriptions );
	void clear();
public:
	CDllTestCollector( const char *_szDllFile ) : szDllFile( _szDllFile ) {}
	bool SetAdditionalDir( const char *szAdditionalDir );
};
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
}
