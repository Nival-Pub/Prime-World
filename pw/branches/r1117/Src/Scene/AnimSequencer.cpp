#include "stdafx.h"
#include "AnimSequencer.h"
#include "Animators.h"
#include "../System/Transform.h"
#include "../System/Spline.h"

#include "../Render/renderer.h"
#include "../Render/renderstates.h"
#include "../Render/renderstatesmanager.h"
#include "../Render/SkeletalMesh.h"
#include "../Render/SkeletalAnimationSampler.h"
#include "../Render/SkeletalAnimationBlender.h"
#include "../Render/renderresourcemanager.h"
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
namespace NScene
{
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
AnimPos::AnimPos( const CVec3 &_pos, const CQuat &_rot )
: pos(_pos)
{
    _rot.DecompEulerAngles( &yaw, &pitch, &roll );
}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
AnimPos::AnimPos( const SHMatrix &m )
{
    pos = m.GetTranslation();
    CQuat rot;
    rot.FromEulerMatrix( m );
    rot.DecompEulerAngles( &yaw, &pitch, &roll );
}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
AnimPos::AnimPos( const Matrix43 &m )
{
    SHMatrix m2;
    Copy( &m2, m );
    pos = m2.GetTranslation();
    CQuat rot;
    rot.FromEulerMatrix( m2 );
    rot.DecompEulerAngles( &yaw, &pitch, &roll );
}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void AnimPos::FillMatrix( SHMatrix *pRes ) const
{
    CQuat rot;
    rot.FromEulerAngles( yaw, pitch, roll );
    pRes->Set( pos, rot );
}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void AnimPos::GetDir( CVec3 *pRes ) const
{
    CQuat rot;
    rot.FromEulerAngles( yaw, pitch, roll );
    rot.GetXAxis( pRes );
}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void AnimPos::GetRotation( CQuat *pRes ) const
{
    pRes->FromEulerAngles( yaw, pitch, roll );
}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
}