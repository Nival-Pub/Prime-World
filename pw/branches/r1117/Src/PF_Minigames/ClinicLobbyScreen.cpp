#include "stdafx.h"

#include "Core/CoreFSM.h"
#include "Client/ScreenCommands.h"

#include "UI/DBUI.h"

#include "Minigames.h"

#include "ClinicLobbyScreen.h"

namespace PF_Minigames
{

REGISTER_SCREEN(ClinicLobbyScreen);

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
ClinicLobbyScreen::ClinicLobbyScreen()
{
  SetShowOnlyOnTop( true );
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
ClinicLobbyScreen::~ClinicLobbyScreen()
{
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
bool ClinicLobbyScreen::Init( UI::User * uiUser )
{
  NI_ASSERT( IsValid( GetMinigames() ), "" );

  logic = new UI::ClinicLobbyScreenLogic;

  SetLogic( logic );
  SetLobbyLogic( logic );
  logic->SetUser( uiUser );

  PF_Minigames::MinigameLobbyScreen::Init( uiUser ); //Very tight call order!

	logic->LoadScreenLayout("ClinicLobbyScreen");
	logic->InitLayout( GetMinigames() );

  return true;
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void ClinicLobbyScreen::OnBecameFront()
{
  PF_Minigames::MinigameLobbyScreen::OnBecameFront();

  NI_VERIFY(logic,"", return);
  logic->RefreshNextLevel();
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void ClinicLobbyScreen::CloseScreen()
{
  CloseThisScreen();
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
} // namespace PF_Minigames

NI_DEFINE_REFCOUNT( PF_Minigames::ClinicLobbyScreen )
